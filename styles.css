@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Rajdhani:wght@400;600;700&family=Orbitron:wght@400;700;900&display=swap');
:root{
  --bg:#050a0f;--panel:#0a1520;--panel2:#0d1e2e;--border:#1a3a5c;
  --accent:#00d4ff;--accent2:#00ff9d;--danger:#ff3d5a;--warn:#ffb800;
  --text:#c8dae8;--dim:#4a6a80;--purple:#bd93f9;--pink:#ff79c6;
  --glow:0 0 20px rgba(0,212,255,0.4);--glow2:0 0 20px rgba(0,255,157,0.4);
  --py-kw:#ff79c6;--py-fn:#50fa7b;--py-str:#f1fa8c;--py-cm:#6272a4;--py-num:#bd93f9;--py-bi:#8be9fd;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--bg);color:var(--text);font-family:'Rajdhani',sans-serif;font-size:13px;height:100vh;overflow:hidden;display:flex;flex-direction:column;}


header{display:flex;align-items:center;justify-content:space-between;padding:7px 14px;border-bottom:1px solid var(--border);background:linear-gradient(90deg,#050a0f,#071525,#050a0f);flex-shrink:0;gap:10px;}
.logo{font-family:'Orbitron',monospace;font-size:18px;font-weight:900;color:var(--accent);text-shadow:var(--glow);letter-spacing:4px;white-space:nowrap;}
.logo span{color:var(--accent2);}
.status-bar{display:flex;gap:14px;font-family:'Share Tech Mono',monospace;font-size:10px;align-items:center;flex-wrap:wrap;}
.stat{display:flex;flex-direction:column;align-items:center;gap:1px;}
.stat-label{color:var(--dim);font-size:8px;letter-spacing:1px;}
.stat-value{color:var(--accent);font-size:12px;}
.stat-value.ok{color:var(--accent2);}
.stat-value.warn{color:var(--warn);}
.stat-value.danger{color:var(--danger);}
.hdr-btn{padding:4px 10px;border:1px solid var(--border);background:transparent;color:var(--dim);font-family:'Share Tech Mono',monospace;font-size:9px;cursor:pointer;transition:all .2s;white-space:nowrap;}
.hdr-btn:hover{border-color:var(--accent);color:var(--accent);}
.hdr-btn.on{border-color:var(--py-fn);color:var(--py-fn);background:rgba(80,250,123,.08);}


.main{display:grid;grid-template-columns:200px 1fr 1fr 230px;flex:1;overflow:hidden;transition:grid-template-columns .35s cubic-bezier(.4,0,.2,1);}
.main.py-hidden{grid-template-columns:200px 1fr 0px 230px;}

.panel{background:var(--panel);border-right:1px solid var(--border);display:flex;flex-direction:column;overflow:hidden;}
.panel.right{border-right:none;border-left:1px solid var(--border);}
.ptitle{font-family:'Orbitron',monospace;font-size:8px;letter-spacing:3px;color:var(--accent);padding:7px 10px;border-bottom:1px solid var(--border);flex-shrink:0;}
.pbody{padding:9px;overflow-y:auto;flex:1;}
.pbody::-webkit-scrollbar{width:3px;}
.pbody::-webkit-scrollbar-thumb{background:var(--border);}
.clabel{font-size:8px;letter-spacing:2px;color:var(--dim);text-transform:uppercase;margin-bottom:4px;display:block;}
.cgroup{margin-bottom:11px;}
.btn{width:100%;padding:5px 9px;background:transparent;border:1px solid var(--border);color:var(--text);font-family:'Rajdhani',sans-serif;font-size:11px;font-weight:600;cursor:pointer;transition:all .2s;margin-bottom:4px;text-align:left;letter-spacing:1px;display:flex;align-items:center;gap:6px;}
.btn:hover{border-color:var(--accent);color:var(--accent);background:rgba(0,212,255,.05);}
.btn.active{border-color:var(--accent2);color:var(--accent2);background:rgba(0,255,157,.08);}
.btn.primary{border-color:var(--accent);color:var(--accent);background:rgba(0,212,255,.08);}
.btn.warn-btn{border-color:var(--warn);color:var(--warn);}
.btn.danger-btn{border-color:var(--danger);color:var(--danger);}
.btn.purple-btn{border-color:var(--purple);color:var(--purple);}
.btn-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0;}
.sw{margin-bottom:7px;}
.sw label{display:flex;justify-content:space-between;font-size:10px;margin-bottom:2px;color:var(--dim);}
.sw label span{color:var(--text);font-family:'Share Tech Mono',monospace;}
input[type=range]{width:100%;-webkit-appearance:none;height:2px;background:var(--border);outline:none;border-radius:2px;}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:10px;height:10px;border-radius:50%;background:var(--accent);cursor:pointer;}
select{width:100%;padding:5px 7px;background:var(--panel2);border:1px solid var(--border);color:var(--text);font-family:'Rajdhani',sans-serif;font-size:11px;cursor:pointer;outline:none;margin-bottom:6px;}
.divider{border:none;border-top:1px solid var(--border);margin:8px 0;opacity:.5;}
.run-btn{width:100%;padding:9px;background:linear-gradient(135deg,rgba(0,212,255,.15),rgba(0,255,157,.08));border:1px solid var(--accent);color:var(--accent);font-family:'Orbitron',monospace;font-size:10px;font-weight:700;cursor:pointer;letter-spacing:2px;transition:all .3s;margin-bottom:5px;}
.run-btn:hover{box-shadow:var(--glow);}
.run-btn:disabled{opacity:.4;cursor:not-allowed;}

.grid-area{position:relative;display:flex;flex-direction:column;overflow:hidden;background:var(--bg);}
.grid-toolbar{display:flex;align-items:center;gap:8px;padding:5px 10px;border-bottom:1px solid var(--border);flex-shrink:0;background:var(--panel);font-size:10px;flex-wrap:wrap;}
.tool-btn{padding:3px 9px;border:1px solid var(--border);background:transparent;color:var(--dim);font-family:'Rajdhani',sans-serif;font-size:10px;font-weight:600;cursor:pointer;transition:all .2s;}
.tool-btn:hover{border-color:var(--accent);color:var(--accent);}
.tool-btn.active{border-color:var(--accent2);color:var(--accent2);background:rgba(0,255,157,.08);}
.grid-wrap{flex:1;position:relative;overflow:hidden;}
#leaflet-map{position:absolute;top:0;left:0;width:100%;height:100%;z-index:0;filter:hue-rotate(180deg) invert(1) brightness(0.55) contrast(1.1);}
.grid-wrap canvas{z-index:1;}
#grid-canvas{z-index:2;}
#fog-canvas{z-index:3;}
#overlay-canvas{z-index:4;}
#canvas3d{z-index:5;}

.map-search{display:none;position:absolute;top:6px;left:50%;transform:translateX(-50%);z-index:10;background:var(--panel);border:1px solid var(--accent);display:flex;gap:4px;padding:4px 6px;font-family:'Share Tech Mono',monospace;font-size:10px;}
.map-search.visible{display:flex;}
.map-search input{background:var(--panel2);border:1px solid var(--border);color:var(--text);padding:3px 7px;font-family:'Share Tech Mono',monospace;font-size:10px;width:220px;outline:none;}
.map-search input:focus{border-color:var(--accent);}
.map-search button{padding:3px 8px;background:rgba(0,212,255,.12);border:1px solid var(--accent);color:var(--accent);font-family:'Share Tech Mono',monospace;font-size:9px;cursor:pointer;letter-spacing:1px;}
.map-search button:hover{background:rgba(0,212,255,.25);}
.map-info{position:absolute;bottom:4px;left:4px;z-index:10;background:rgba(5,10,15,.8);border:1px solid var(--border);color:var(--dim);font-family:'Share Tech Mono',monospace;font-size:8px;padding:3px 7px;pointer-events:none;letter-spacing:1px;}
#grid-canvas{position:absolute;top:0;left:0;image-rendering:pixelated;cursor:crosshair;}
#osm-canvas{position:absolute;top:0;left:0;image-rendering:pixelated;pointer-events:none;opacity:.35;}
#fog-canvas{position:absolute;top:0;left:0;pointer-events:none;}
#overlay-canvas{position:absolute;top:0;left:0;pointer-events:none;cursor:crosshair;}

.alert-banner{position:absolute;top:0;left:0;right:0;z-index:100;background:rgba(255,61,90,.9);color:#fff;font-family:'Orbitron',monospace;font-size:11px;letter-spacing:2px;padding:6px 14px;display:flex;align-items:center;gap:10px;transform:translateY(-100%);transition:transform .3s ease;border-bottom:2px solid var(--danger);}
.alert-banner.show{transform:translateY(0);}
.alert-close{margin-left:auto;cursor:pointer;font-size:16px;background:none;border:none;color:#fff;}


.wp-list{max-height:120px;overflow-y:auto;margin-bottom:6px;}
.wp-item{display:flex;align-items:center;justify-content:space-between;padding:3px 6px;border:1px solid var(--border);margin-bottom:3px;font-family:'Share Tech Mono',monospace;font-size:10px;background:var(--panel2);}
.wp-item .wp-num{color:var(--purple);min-width:18px;}
.wp-item .wp-coords{color:var(--text);}
.wp-item .wp-del{color:var(--danger);cursor:pointer;background:none;border:none;font-size:12px;padding:0 2px;}
.wp-item.active-wp{border-color:var(--warn);background:rgba(255,184,0,.08);}


.py-panel{background:#0a0f1a;border-left:1px solid var(--border);display:flex;flex-direction:column;overflow:hidden;transition:width .35s cubic-bezier(.4,0,.2,1),opacity .3s,min-width .35s;}
.py-panel.collapsed{width:0!important;min-width:0!important;opacity:0;border-left:none;pointer-events:none;}
.py-toolbar{display:flex;align-items:center;gap:5px;padding:5px 9px;border-bottom:1px solid var(--border);flex-shrink:0;background:var(--panel);}
.py-tab{padding:2px 9px;border:1px solid var(--border);background:transparent;color:var(--dim);font-family:'Share Tech Mono',monospace;font-size:9px;cursor:pointer;transition:all .2s;}
.py-tab.active{border-color:var(--py-fn);color:var(--py-fn);background:rgba(80,250,123,.08);}
.py-code{flex:1;overflow-y:auto;padding:9px 11px;font-family:'Share Tech Mono',monospace;font-size:10.5px;line-height:1.6;}
.py-code::-webkit-scrollbar{width:3px;}
.py-code::-webkit-scrollbar-thumb{background:var(--border);}
.py-line{display:flex;min-height:17px;}
.py-ln{color:var(--dim);min-width:28px;text-align:right;padding-right:9px;user-select:none;font-size:9px;}
.py-src{flex:1;white-space:pre;}
.py-line.run-highlight{background:rgba(0,255,157,.15);border-left:2px solid var(--accent2);animation:pline .5s ease;}
@keyframes pline{0%{background:rgba(0,255,157,.4);}100%{background:rgba(0,255,157,.15);}}
.kw{color:var(--py-kw);} .fn{color:var(--py-fn);} .st{color:var(--py-str);} .cm{color:var(--py-cm);font-style:italic;} .nm{color:var(--py-num);} .bi{color:var(--py-bi);}
.pybadge{background:rgba(80,250,123,.15);border:1px solid var(--py-fn);color:var(--py-fn);font-family:'Share Tech Mono',monospace;font-size:8px;padding:2px 7px;letter-spacing:1px;}


.bat-bar{height:11px;background:var(--panel2);border:1px solid var(--border);overflow:hidden;margin-bottom:8px;}

.speed-graph-wrap{background:var(--panel2);border:1px solid var(--accent);padding:6px;margin-bottom:7px;}
.speed-graph-title{display:flex;justify-content:space-between;font-family:'Share Tech Mono',monospace;font-size:9px;color:var(--accent);margin-bottom:4px;letter-spacing:1px;}
#speed-canvas{display:block;width:100%;height:48px;}
.speed-stats{display:flex;justify-content:space-between;margin-top:4px;font-family:'Share Tech Mono',monospace;font-size:9px;}
.speed-stat{text-align:center;}
.speed-stat .sv{color:var(--accent);font-size:11px;display:block;}
.speed-stat .sl{color:var(--dim);font-size:8px;}
.bat-fill{height:100%;background:linear-gradient(90deg,var(--accent2),var(--accent));transition:width .5s,background .5s;position:relative;}
.bat-fill::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.15),transparent);animation:shimmer 2s infinite;}
@keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
.mgrid{display:grid;grid-template-columns:1fr 1fr;gap:4px;margin-bottom:9px;}
.mcard{background:var(--panel2);border:1px solid var(--border);padding:5px;text-align:center;}
.mcard .v{font-family:'Orbitron',monospace;font-size:14px;color:var(--accent);display:block;}
.mcard .l{font-size:8px;color:var(--dim);letter-spacing:1px;display:block;}
.gfdot{width:7px;height:7px;border-radius:50%;background:var(--accent2);animation:blink 1.5s infinite;flex-shrink:0;}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.2}}
.gfdot.danger{background:var(--danger);}
.gfdot.warn{background:var(--warn);}
.log-box{background:var(--panel2);border:1px solid var(--border);padding:6px;font-family:'Share Tech Mono',monospace;font-size:9.5px;overflow-y:auto;max-height:160px;margin-bottom:8px;}
.log-box::-webkit-scrollbar{width:3px;}
.log-box::-webkit-scrollbar-thumb{background:var(--border);}
.le{padding:2px 0;border-bottom:1px solid rgba(26,58,92,.3);}
.lt{color:var(--dim);margin-right:4px;}
.lok{color:var(--accent2);} .lwarn{color:var(--warn);} .lerr{color:var(--danger);} .linfo{color:var(--accent);}
.legend{display:flex;flex-direction:column;gap:3px;}
.li{display:flex;align-items:center;gap:6px;font-size:10px;}
.ld{width:9px;height:9px;border-radius:2px;flex-shrink:0;}


#canvas3d{position:absolute;top:0;left:0;display:none;}
.grid-wrap.view3d #grid-canvas,.grid-wrap.view3d #osm-canvas,.grid-wrap.view3d #fog-canvas,.grid-wrap.view3d #overlay-canvas{display:none;}
.grid-wrap.view3d #canvas3d{display:block;}


.energy-tooltip{position:absolute;background:rgba(5,10,15,.95);border:1px solid var(--accent);color:var(--text);font-family:'Share Tech Mono',monospace;font-size:10px;padding:4px 8px;pointer-events:none;z-index:50;display:none;}
